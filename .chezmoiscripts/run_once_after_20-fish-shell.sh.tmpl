#!/usr/bin/env bash
set -euo pipefail

echo "üåç Activating Homebrew environment..."
eval "$("$BREW_PREFIX/bin/brew" shellenv)"

if FISH_PATH="$(command -v fish)"; then
    echo "üê† Configuring Fish shell..."
    echo "   Found at: $FISH_PATH"

    if ! grep -q "$FISH_PATH" /etc/shells; then
        echo "   Adding to /etc/shells..."
        echo "$FISH_PATH" | sudo tee -a /etc/shells >/dev/null
    fi

    if [[ "$SHELL" != "$FISH_PATH" ]]; then
        echo "   Changing default shell to Fish..."
        sudo chsh -s "$FISH_PATH" "$USER"
    else
        echo "   Fish is already the default shell."
    fi
else
    echo "‚ö†Ô∏è  Fish command not found in PATH."
fi

echo "‚úÖ Successfully configured fish as default shell!"
